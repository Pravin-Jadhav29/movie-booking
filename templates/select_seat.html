{% extends 'base.html' %}
{% load static %}

{% block content %}

<div class="container text-center mt-4">

    <!-- SCREEN -->
    <div class="screen mb-4">
        SCREEN
    </div>

    <form method="POST">
        {% csrf_token %}

        <!-- ðŸŽ¬ Seat Layout -->
        <div class="seat-layout">

        {% for seat in seats %}

            {% if seat|slice:"1:" == "1" %}
                <div class="seat-row">
            {% endif %}

            {% if seat|slice:"1:" == "3" %}
                <div class="aisle"></div>
            {% endif %}

            {% if seat|slice:"1:" == "13" %}
                <div class="aisle"></div>
            {% endif %}

            {% if seat in booked_seats %}
                <div class="seat booked">
                    {{ seat }}
                </div>
            {% else %}
                <label class="seat available">
                    <input type="checkbox" name="seats" value="{{ seat }}">
                    <span>{{ seat }}</span>
                </label>
            {% endif %}

            {% if seat|slice:"1:" == "14" %}
                </div>
            {% endif %}

        {% endfor %}

        </div>

        <!-- ðŸŽŸ Seat Legend -->
        <div class="mt-4">
            <span class="badge bg-success me-2">Available</span>
            <span class="badge bg-danger me-2">Booked</span>
            <span class="badge bg-warning text-dark">Selected</span>
        </div>

        <!-- ðŸ’° Total Price -->
        <p id="total-price" class="fw-bold mt-3">
            Total: â‚¹0
        </p>

        <!-- Confirm Button -->
        <button type="submit" class="btn btn-danger px-4">
            Confirm Booking
        </button>

    </form>

</div>

<!-- ðŸ’° Price Calculation Script -->
<script>
    const seatPrice = 150;
    const checkboxes = document.querySelectorAll('input[name="seats"]');
    const totalDisplay = document.getElementById('total-price');

    checkboxes.forEach(box => {
        box.addEventListener('change', () => {
            const checked = document.querySelectorAll('input[name="seats"]:checked');
            const total = checked.length * seatPrice;
            totalDisplay.innerText = "Total: â‚¹" + total;
        });
    });
</script>

{% endblock %}